var y=Object.defineProperty;var x=(s,t,e)=>t in s?y(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var p=(s,t,e)=>x(s,typeof t!="symbol"?t+"":t,e);import{B as b}from"./BaseApp-BM3Paybi.js";import{d as V,r as H,g,o as N,a as L,c as U,b as i,h as d,w as u,t as k,i as h,f as B,j as v,_ as F}from"./index-BaoKA7RB.js";class A{constructor(){p(this,"state",{content:"",saved:!0,filename:"untitled.txt",wordCount:0,lineCount:1})}getState(){return{...this.state}}setState(t){this.state={...this.state,...t}}setContent(t){this.setState({content:t,saved:!1,wordCount:this.countWords(t),lineCount:this.countLines(t)})}setFilename(t){this.setState({filename:t})}markAsSaved(){this.setState({saved:!0})}clear(){this.setState({content:"",saved:!0,filename:"untitled.txt",wordCount:0,lineCount:1})}countWords(t){return t.trim().split(/\s+/).filter(e=>e.length>0).length}countLines(t){return t.split(`
`).length}getContent(){return this.state.content}getFilename(){return this.state.filename}isSaved(){return this.state.saved}}class W extends b{constructor(e){super(e);p(this,"core");this.core=new A}async init(){const e=this.getState("state");e&&this.core.setState(e),this.on("state:change",()=>{this.setState("state",this.core.getState())})}async destroy(){this.clearState("state")}getNotepadState(){return this.core.getState()}setContent(e){this.core.setContent(e),this.emit({type:"state:change",payload:this.core.getState()})}async saveFile(e){e&&this.core.setFilename(e);const r=new Blob([this.core.getContent()],{type:"text/plain"}),l=URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download=this.core.getFilename(),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l),this.core.markAsSaved(),this.emit({type:"state:change",payload:this.core.getState()})}newFile(){this.core.clear(),this.emit({type:"state:change",payload:this.core.getState()})}hasUnsavedChanges(){return!this.core.isSaved()}}const M={class:"notepad"},I={class:"toolbar"},R={class:"editor"},j={class:"status-bar"},$=V({__name:"Notepad",props:{app:{}},setup(s){const t=s,e=H(t.app.getNotepadState()),r=g({get:()=>e.value.content,set:a=>n(a)}),l=g(()=>{const{wordCount:a,lineCount:o,saved:c}=e.value;return`${a} 个字 | ${o} 行${c?"":" | 未保存"}`}),n=a=>{t.app.setContent(a)},w=async()=>{t.app.hasUnsavedChanges()&&!window.confirm("当前文件未保存，是否继续？")||t.app.newFile()},f=async()=>{await t.app.saveFile()},m=a=>{e.value=a.payload};return N(()=>{t.app.on("state:change",m)}),L(()=>{t.app.off("state:change",m)}),(a,o)=>{const c=h("el-button"),C=h("el-button-group"),_=h("el-input");return B(),U("div",M,[i("div",I,[d(C,null,{default:u(()=>[d(c,{onClick:w},{default:u(()=>o[1]||(o[1]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor"},[i("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1),v(" 新建 ")])),_:1}),d(c,{onClick:f},{default:u(()=>o[2]||(o[2]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor"},[i("path",{d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"})],-1),v(" 保存 ")])),_:1})]),_:1})]),i("div",R,[d(_,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=S=>r.value=S),type:"textarea",rows:2,class:"editor-textarea",resize:"none",onInput:n},null,8,["modelValue"])]),i("div",j,[i("span",null,k(l.value),1)])])}}}),Z=F($,[["__scopeId","data-v-b1d59756"]]);export{Z as UI,W as default};
